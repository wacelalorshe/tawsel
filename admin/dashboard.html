<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ููุญุฉ ุงูุชุญูู - ูุชุฌุฑู ุงูุฅููุชุฑููู</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/style.css" rel="stylesheet">
    
    <!-- ๐ฅ ููุชุจุงุช Firebase -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script src="../js/firebase-config.js"></script>
    <script src="../js/firebase-db.js"></script>
    <script src="../js/admin-products.js"></script>
</head>
<body>
    <div class="container-fluid">
        <div class="row">
            <!-- ุงูุดุฑูุท ุงูุฌุงูุจู -->
            <nav class="col-md-3 col-lg-2 d-md-block sidebar">
                <div class="position-sticky pt-3">
                    <h4 class="text-white text-center mb-4">๐ ูุชุฌุฑู</h4>
                    <ul class="nav flex-column">
                        <li class="nav-item">
                            <a class="nav-link active text-white" href="dashboard.html">
                                ๐ ุงูุฑุฆูุณูุฉ
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link text-white" href="products.html">
                                ๐ฆ ุฅุฏุงุฑุฉ ุงูููุชุฌุงุช
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link text-white" href="../index.html">
                                ๐ช ุงูุนูุฏุฉ ูููุชุฌุฑ
                            </a>
                        </li>
                    </ul>
                </div>
            </nav>

            <!-- ุงููุญุชูู ุงูุฑุฆูุณู -->
            <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
                <!-- ุงูุนููุงู ุงูุฑุฆูุณู -->
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <h2 class="text-primary">๐ ููุญุฉ ุงูุชุญูู</h2>
                    <div class="btn-toolbar mb-2 mb-md-0">
                        <button class="btn btn-sm btn-outline-secondary" onclick="location.reload()">
                            ๐ ุชุญุฏูุซ
                        </button>
                    </div>
                </div>

                <!-- ุงูุจุทุงูุงุช ุงูุฅุญุตุงุฆูุฉ -->
                <div class="row">
                    <div class="col-md-4">
                        <div class="card text-white bg-primary mb-3">
                            <div class="card-body text-center">
                                <h5 class="card-title">๐ฆ ุงูููุชุฌุงุช</h5>
                                <p class="card-text display-4" id="products-count">0</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="card text-white bg-success mb-3">
                            <div class="card-body text-center">
                                <h5 class="card-title">๐ ุงููุจูุนุงุช</h5>
                                <p class="card-text display-4">0</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="card text-white bg-warning mb-3">
                            <div class="card-body text-center">
                                <h5 class="card-title">๐ฅ ุงูุนููุงุก</h5>
                                <p class="card-text display-4">0</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ุฃุฒุฑุงุฑ ุงูุฅุฌุฑุงุกุงุช ุงูุณุฑูุนุฉ -->
                <div class="row mt-4">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-body">
                                <h5 class="card-title text-primary">๐ ุงูุฅุฌุฑุงุกุงุช ุงูุณุฑูุนุฉ</h5>
                                <div class="d-flex flex-wrap gap-2">
                                    <button class="btn btn-success" onclick="addNewProduct()">
                                        โ ุฅุถุงูุฉ ููุชุฌ ุฌุฏูุฏ
                                    </button>
                                    <a href="products.html" class="btn btn-outline-primary">
                                        ๐ ุฅุฏุงุฑุฉ ุงูููุชุฌุงุช
                                    </a>
                                    <button class="btn btn-warning" onclick="addSampleProduct()">
                                        ๐งช ุฅุถุงูุฉ ููุชุฌ ุชุฌุฑูุจู
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ุฃุญุฏุซ ุงูููุชุฌุงุช -->
                <div class="row mt-5">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-header bg-light">
                                <h5 class="card-title mb-0">๐ ุฃุญุฏุซ ุงูููุชุฌุงุช</h5>
                            </div>
                            <div class="card-body">
                                <div id="admin-products-container" class="row">
                                    <!-- ุงูููุชุฌุงุช ุชุธูุฑ ููุง -->
                                    <div class="col-12 text-center">
                                        <div class="text-muted py-4">
                                            <p>๐ ุฌุงุฑู ุชุญููู ุงูููุชุฌุงุช...</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ูุณู ุงูุชุตุญูุญ -->
                <div class="row mt-5">
                    <div class="col-12">
                        <div class="card border-warning">
                            <div class="card-header bg-warning">
                                <h5 class="card-title">๐ ุชุตุญูุญ ุงูุฃุฎุทุงุก</h5>
                            </div>
                            <div class="card-body">
                                <div class="d-flex flex-wrap gap-2">
                                    <button class="btn btn-info btn-sm" onclick="testConnection()">
                                        ุงุฎุชุจุงุฑ ุงูุงุชุตุงู
                                    </button>
                                    <button class="btn btn-success btn-sm" onclick="addTestProduct()">
                                        ุฅุถุงูุฉ ููุชุฌ ุชุฌุฑูุจู
                                    </button>
                                    <a href="../debug.html" class="btn btn-warning btn-sm">
                                        ุตูุญุฉ ุงูุชุตุญูุญ ุงููุงููุฉ
                                    </a>
                                </div>
                                <div id="debug-result" class="mt-2"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- ุณูุฑูุจุช ุงูุชุตุญูุญ -->
    <script>
        // ุฏูุงู ุงูุชุตุญูุญ
        function testConnection() {
            const result = document.getElementById('debug-result');
            result.innerHTML = '<div class="alert alert-info">๐ ุฌุงุฑู ุงุฎุชุจุงุฑ ุงูุงุชุตุงู...</div>';
            
            setTimeout(() => {
                if (typeof firebase === 'undefined') {
                    result.innerHTML = '<div class="alert alert-danger">โ ููุชุจุฉ Firebase ุบูุฑ ูุญููุฉ</div>';
                    return;
                }
                
                if (typeof db === 'undefined') {
                    result.innerHTML = '<div class="alert alert-danger">โ ูุงุนุฏุฉ ุงูุจูุงูุงุช ุบูุฑ ูุญููุฉ</div>';
                    return;
                }
                
                result.innerHTML = '<div class="alert alert-success">โ ุงูุงุชุตุงู ูุน Firebase ูุนูู ุจุดูู ุตุญูุญ</div>';
            }, 1000);
        }

        async function addTestProduct() {
            const result = document.getElementById('debug-result');
            result.innerHTML = '<div class="alert alert-info">๐ ุฌุงุฑู ุฅุถุงูุฉ ููุชุฌ ุชุฌุฑูุจู...</div>';
            
            try {
                const testProduct = {
                    name: "ููุชุฌ ุชุฌุฑูุจู ููุงุฎุชุจุงุฑ",
                    price: 99.99,
                    description: "ูุฐุง ููุชุฌ ููุงุฎุชุจุงุฑ ููุท",
                    category: "ุงุฎุชุจุงุฑ",
                    image: "https://via.placeholder.com/300x200/28a745/ffffff?text=ููุชุฌ+ุชุฌุฑูุจู",
                    dateAdded: new Date().toLocaleDateString('ar-EG')
                };
                
                await addProductToFirebase(testProduct);
                result.innerHTML = '<div class="alert alert-success">โ ุชู ุฅุถุงูุฉ ุงูููุชุฌ ุงูุชุฌุฑูุจู ุจูุฌุงุญ</div>';
                
                // ุชุญุฏูุซ ุงูุนุฑุถ
                setTimeout(() => {
                    displayProductsInAdmin();
                    updateProductsCount();
                }, 1000);
                
            } catch (error) {
                result.innerHTML = `<div class="alert alert-danger">โ ูุดู ุงูุฅุถุงูุฉ: ${error.message}</div>`;
            }
        }

        // ุชุญุฏูุซ ุนุฏุฏ ุงูููุชุฌุงุช
        async function updateProductsCount() {
            try {
                const products = await getProductsFromFirebase();
                const countElement = document.getElementById('products-count');
                if (countElement) {
                    countElement.textContent = products.length;
                }
            } catch (error) {
                console.error('ุฎุทุฃ ูู ุชุญุฏูุซ ุงูุนุฏุฏ:', error);
            }
        }

        // ุงูุชููุฆุฉ ุนูุฏ ุชุญููู ุงูุตูุญุฉ
        document.addEventListener('DOMContentLoaded', function() {
            console.log('๐ ููุญุฉ ุงูุชุญูู ุฌุงูุฒุฉ ููุชุดุบูู');
            updateProductsCount();
            
            // ุชุญููู ุงูููุชุฌุงุช ุจุนุฏ ุซุงููุชูู
            setTimeout(() => {
                displayProductsInAdmin();
            }, 2000);
        });
    </script>
</body>
</html>
